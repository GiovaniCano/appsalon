const APIbaseURL="http://localhost:3000/api/";let paso=1;const cita={usuarioId:"",nombre:"",fecha:"",hora:"",servicios:[]};function iniciarAPP(){tabs(),botonesPaginador(),paginaAnterior(),paginaSiguiente(),consultarAPI_jQuery(),idCliente(),nombreCliente(),seleccionarFecha(),seleccionarHora()}function reservarCita_jQuery(){const a={...cita};a.servicios=a.servicios.map(a=>a.id),$.ajax({url:"/api/citas",method:"post",dataType:"json",data:a,error:alertaErrorPOST,success:function(a){a.resultado.resultado?Swal.fire({icon:"success",title:"Cita Creada",text:"Tu cita fué creada correctamente",customClass:{popup:"swal2-custom-size"}}).then(()=>window.location.reload()):alertaErrorPOST()}})}async function reservarCita_Fetch(){const{usuarioId:a,fecha:e,hora:o,servicios:t}=cita,r=t.map(a=>a.id),i=new FormData;i.append("usuarioId",a),i.append("fecha",e),i.append("hora",o),i.append("servicios",r);try{const a=await fetch("/api/citas",{method:"post",body:i});(await a.json()).resultado.resultado?Swal.fire({icon:"success",title:"Cita Creada",text:"Tu cita fué creada correctamente",customClass:{popup:"swal2-custom-size"}}).then(()=>window.location.reload()):alertaErrorPOST()}catch(a){alertaErrorPOST()}}function alertaErrorPOST(){Swal.fire({icon:"error",title:"Error",text:"Hubo un error al guardar la cita",customClass:{popup:"swal2-custom-size"},footer:'<a href="/cita">Recargar la página</a>'})}function mostrarResumen(){const a=$("#resumen");if(Object.values(cita).includes("")||0===cita.servicios.length)a.children().remove(),mostrarAlerta("Faltan datos o elegir al menos un servicio","error","#resumen",!1);else{a.children().remove();const{nombre:e,servicios:o}=cita;let t=cita.hora.split(":");t=t[0]>12?t[0]-12+":"+t[1]+" p.m.":12==t[0]?t.join(":")+" p.m.":t.join(":")+" a.m.";let r=cita.fecha.split("-");r=new Date(r[0],r[1]-1,r[2]),r=r.toLocaleDateString("es",{year:"numeric",weekday:"long",day:"numeric",month:"long"}),r=r[0].toUpperCase()+r.substring(1);const i=$("<p></p>").html("<span>Nombre:</span> "+e),s=$("<p></p>").html("<span>Fecha:</span> "+r),c=$("<p></p>").html("<span>Hora:</span> "+t);a.append(i,s,c),o.forEach(e=>{const{id:o,precio:t,nombre:r}=e,i=$("<div></div>").addClass("contenedor-servicio"),s=$("<p></p>").text(r),c=$("<div></div>").html("<span>Precio: </span>$ "+t);i.append(s,c),a.append(i)});const n=$("<button></button>").addClass("boton").text("Reservar Cita");n.on("click",reservarCita_jQuery),a.append(n)}}function seleccionarHora(){$("#hora").on("input",(function(a){const e=$(this).val(),o=e.split(":")[0];o<10||o>18?($(this).val(""),mostrarAlerta("Abierto de 10:00 a.m. a 6:00 p.m.","error","#paso-2"),cita.hora=""):cita.hora=e}))}function seleccionarFecha(){$("#fecha").on("input",(function(a){const e=$(this).val(),o=new Date(e).getUTCDay();[0,6].includes(o)?($(this).val(""),mostrarAlerta("Fines de semana no abrimos","error","#paso-2"),cita.fecha=""):cita.fecha=e}))}function nombreCliente(){cita.nombre=$("#nombre").val()}function idCliente(){cita.usuarioId=$("#id").val()}function mostrarAlerta(a,e,o,t=!0){$(".alerta").length&&$(".alerta").remove();const r=$("<div></div>").text(a).addClass("alerta").addClass(e);$(o).prepend(r),t&&setTimeout(()=>r.remove(),4e3)}function quitarAlertas(){const a=$(".alerta");a&&setTimeout(()=>a.remove(),4e3)}async function consultarAPI_Fetch(){try{const a=await fetch("/api/servicios");mostrarServicios(await a.json())}catch(a){cl(a)}}function consultarAPI_jQuery(){$.ajax({url:"/api/servicios",type:"get",dataType:"json",success:a=>mostrarServicios(a),error:()=>cl("error al cargar los servicios"),timeout:4e3})}function mostrarServicios(a){a.forEach(a=>{const{id:e,nombre:o,precio:t}=a,r=$("<p></p>").addClass("nombre-servicio").text(o),i=$("<p></p>").addClass("precio-servicio").text("$ "+t),s=$("<div></div>").addClass("servicio").attr("data-id-servicio",e);s.on("click",(function(){seleccionarServicio(a)})),s.append(r,i),$("#servicios").append(s)})}function seleccionarServicio(a){const{id:e}=a,{servicios:o}=cita;o.some(a=>a.id===e)?(cita.servicios=o.filter(a=>a.id!==e),$(`[data-id-servicio="${e}"]`).removeClass("seleccionado")):(cita.servicios=[...o,a],$(`[data-id-servicio="${e}"]`).addClass("seleccionado"))}function tabs(){$(".tabs button").on("click",(function(a){paso=$(this).data("paso"),mostrarSeccion()}))}function mostrarSeccion(){$(".mostrar").removeClass("mostrar");$("#paso-"+paso).addClass("mostrar");$(".actual").removeClass("actual");$(`[data-paso="${paso}"]`).addClass("actual"),botonesPaginador(),3===paso&&mostrarResumen()}function botonesPaginador(){const a=$("#anterior"),e=$("#siguiente");1===paso?(a.addClass("ocultar"),e.removeClass("ocultar")):3===paso?(e.addClass("ocultar"),a.removeClass("ocultar")):(e.removeClass("ocultar"),a.removeClass("ocultar"))}function paginaAnterior(){$("#anterior").on("click",(function(){paso--,mostrarSeccion()}))}function paginaSiguiente(){$("#siguiente").on("click",(function(){paso++,mostrarSeccion()}))}function cl(a){console.log(a)}$((function(){iniciarAPP()}));
//# sourceMappingURL=app.js.map
